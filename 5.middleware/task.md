# Практическое задание

Чтобы научиться применять принципы работы с middleware-компонентов в Django и укрепить понимание их функциональности, предлагаем вам разработать собственное middleware. Оно будет логировать информацию о каждом запросе в терминал: дату и время запроса, IP-адрес клиента, полный путь запроса.

## Шаги выполнения задания

1. Создание middleware

    Создайте новый класс middleware в вашем Django-приложении.

    - Определите в классе методы `__init__` и `__call__`
    Создайте класс `VerboseLoggingMiddleware`;
    - Добавьте инициализатор класса, принимающий параметр `get_response`;
    - В инициализаторе сохраните значение параметра `get_response` в атрибут `self.get_response`.

2. Логирование информации о запросе
    - В методе `__call__` вашего middleware добавьте логирование пути входящего запроса. 
    - Используйте Python-библиотеку для логирования: `logging`.
    - Метод `__call__` должен принимать параметр `request`.
    - В методе `__call__` вызовите метод `log_request`, передайте туда параметр request.
    Верните результат вызова `self.get_response` с параметром `request`.

3. Подробное логирование информации о запросе

    Реализуйте метод `log_request`: 
    - Для класса `VerboseLoggingMiddleware` объявите метод `log_request`, принимающий параметр `request`.
    - В методе `log_request` вызовите метод `info` у объекта `logger`, передав туда следующие параметры:

        a. Строчка с текстом лога (информация о запросе, позиции для форматирования должны быть обозначены процентным форматированием;

        b. Текущее время, например, через datetime.now();

        c. Получение айпи клиента, например создайте метод экземпляра класса, вызывайте его так: `self.get_client_ip(request)`;
        
        d. Получение полного пути запроса, например `request.get_full_path()`.

    - Реализуйте метод класса `get_client_ip`, принимающий параметр request:

        a. В методе `get_client_ip` получите значение заголовка `HTTP_X_FORWARDED_FOR` из атрибута `META` объекта `request` и сохраните в переменной. Проверьте, если значение в переменной существует, тогда разделите значение по запятой и присвойте первый элемент новой переменной;

        b. Иначе, сохраните значение атрибута `REMOTE_ADDR` объекта `META` в новую переменную;

        c. Верните значение переменной.

4. Интеграция middleware

Добавьте ваше middleware в настройки Django (`settings.py`), включив его в список `MIDDLEWARE`.

> Это задание поможет вам практически применить знания о middleware в Django, а также научит вас мониторингу и анализу производительности запросов в ваших веб-приложениях.